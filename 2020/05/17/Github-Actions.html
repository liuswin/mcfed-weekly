<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Github Actions | MCFED</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Github Actions" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <link rel="canonical" href="https://liuswin.github.io//mcfed-weekly/2020/05/17/Github-Actions.html" /> <meta property="og:url" content="https://liuswin.github.io//mcfed-weekly/2020/05/17/Github-Actions.html" /> <meta property="og:site_name" content="MCFED" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-05-17T06:22:45+00:00" /> <script type="application/ld+json"> {"description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","@type":"BlogPosting","url":"https://liuswin.github.io//mcfed-weekly/2020/05/17/Github-Actions.html","headline":"Github Actions","datePublished":"2020-05-17T06:22:45+00:00","dateModified":"2020-05-17T06:22:45+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://liuswin.github.io//mcfed-weekly/2020/05/17/Github-Actions.html"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="/mcfed-weekly/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77"> <link rel="icon" type="image/png" sizes="32x32" href="/mcfed-weekly/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77"> <link rel="icon" type="image/png" sizes="16x16" href="/mcfed-weekly/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77"> <link rel="manifest" href="/mcfed-weekly/assets/img/icons/manifest.json?v=qA3OXqyw77"> <link rel="mask-icon" href="/mcfed-weekly/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5"> <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]--> <link rel="shortcut icon" href="/mcfed-weekly/assets/img/icons/favicon.ico?v=qA3OXqyw77"> <meta name="apple-mobile-web-app-title" content="Sleek"> <meta name="application-name" content="Sleek"> <meta name="msapplication-config" content="/mcfed-weekly/assets/img/icons/browserconfig.xml?v=qA3OXqyw77"> <meta name="theme-color" content="#ffffff"> <style class="inlineCSS"> h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#313237}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px;max-width:100%;margin:0 auto}@media only screen and (min-width:36em){.container{max-width:540px;margin:0 auto}}@media only screen and (min-width:48em){.container{max-width:720px;margin:0 auto}}@media only screen and (min-width:62em){.container{max-width:960px;margin:0 auto}}@media only screen and (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media only screen and (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__inner{display:block;position:relative;padding:1.875rem 1.25rem .625rem;width:100%;color:#838c8d;border-bottom:0}.post-card__header{margin-bottom:.75rem}.post-card__meta{font-size:.875rem}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media only screen and (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media only screen and (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}} </style> <link rel="preload" href="/mcfed-weekly/assets/css/main.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="/mcfed-weekly/assets/css/main.css"></noscript> <script type="text/javascript"> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ (function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}} var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1} return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia} if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)} setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return} var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}} if(typeof exports!=="undefined"){exports.loadCSS=loadCSS} else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this)) </script> </head> <body class="site"> <header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation"> <div class="container"> <div class="header__inner"> <a class="header__logo" href="/mcfed-weekly/"> <div class="header__logo--container"> <svg class="logo" viewBox="0 0 47 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g id="logo" transform="translate(-113.000000, -89.000000)"> <path d="M114.657,93.712 C114.657,93.1479972 114.767999,92.6530021 114.99,92.227 C115.212001,91.8009979 115.505998,91.4470014 115.872,91.165 C116.238002,90.8829986 116.663998,90.6700007 117.15,90.526 C117.636002,90.3819993 118.136997,90.31 118.653,90.31 C119.457004,90.31 120.218996,90.4629985 120.939,90.769 C121.659004,91.0750015 122.258998,91.5219971 122.739,92.11 L121.371,93.406 C121.094999,92.9859979 120.708002,92.6560012 120.21,92.416 C119.711998,92.1759988 119.193003,92.056 118.653,92.056 C118.004997,92.056 117.519002,92.1909986 117.195,92.461 C116.870998,92.7310013 116.709,93.1059976 116.709,93.586 C116.709,93.8740014 116.771999,94.1259989 116.898,94.342 C117.024001,94.5580011 117.194999,94.7469992 117.411,94.909 C117.627001,95.0710008 117.878999,95.2149994 118.167,95.341 C118.455001,95.4670006 118.754998,95.5959993 119.067,95.728 C119.475002,95.8960008 119.888998,96.075999 120.309,96.268 C120.729002,96.460001 121.106998,96.6999986 121.443,96.988 C121.779002,97.2760014 122.054999,97.6299979 122.271,98.05 C122.487001,98.4700021 122.595,98.9919969 122.595,99.616 C122.595,100.276003 122.481001,100.836998 122.253,101.299 C122.024999,101.761002 121.716002,102.138999 121.326,102.433 C120.935998,102.727001 120.483003,102.939999 119.967,103.072 C119.450997,103.204001 118.911003,103.27 118.347,103.27 C117.386995,103.27 116.526004,103.084002 115.764,102.712 C115.001996,102.339998 114.339003,101.758004 113.775,100.966 L115.197,99.778 C115.305001,99.9580009 115.460999,100.152999 115.665,100.363 C115.869001,100.573001 116.105999,100.767999 116.376,100.948 C116.646001,101.128001 116.945998,101.277999 117.276,101.398 C117.606002,101.518001 117.962998,101.578 118.347,101.578 C118.767002,101.578 119.117999,101.53 119.4,101.434 C119.682001,101.338 119.906999,101.206001 120.075,101.038 C120.243001,100.869999 120.363,100.675001 120.435,100.453 C120.507,100.230999 120.543,99.9940013 120.543,99.742 C120.543,99.4299984 120.474001,99.1570012 120.336,98.923 C120.197999,98.6889988 120.015001,98.4820009 119.787,98.302 C119.558999,98.1219991 119.295001,97.9600007 118.995,97.816 C118.694998,97.6719993 118.383002,97.5280007 118.059,97.384 C117.662998,97.2159992 117.261002,97.036001 116.853,96.844 C116.444998,96.651999 116.079002,96.4180014 115.755,96.142 C115.430998,95.8659986 115.167001,95.5330019 114.963,95.143 C114.758999,94.7529981 114.657,94.2760028 114.657,93.712 Z M127.167,89.824 L127.167,103 L125.097,103 L125.097,89.824 L127.167,89.824 Z M131.775,99.364 C131.859,100.192004 132.119998,100.794998 132.558,101.173 C132.996002,101.551002 133.598996,101.74 134.367,101.74 C134.859002,101.74 135.341998,101.662001 135.816,101.506 C136.290002,101.349999 136.700998,101.134001 137.049,100.858 L137.877,102.136 C137.336997,102.496002 136.749003,102.768999 136.113,102.955 C135.476997,103.141001 134.841003,103.234 134.205,103.234 C133.592997,103.234 133.014003,103.141001 132.468,102.955 C131.921997,102.768999 131.442002,102.490002 131.028,102.118 C130.613998,101.745998 130.284001,101.278003 130.038,100.714 C129.791999,100.149997 129.669,99.4840038 129.669,98.716 C129.669,98.0799968 129.779999,97.4920027 130.002,96.952 C130.224001,96.4119973 130.532998,95.947002 130.929,95.557 C131.325002,95.1669981 131.789997,94.8610011 132.324,94.639 C132.858003,94.4169989 133.430997,94.306 134.043,94.306 C134.631003,94.306 135.170998,94.3989991 135.663,94.585 C136.155002,94.7710009 136.580998,95.0439982 136.941,95.404 C137.301002,95.7640018 137.582999,96.2109973 137.787,96.745 C137.991001,97.2790027 138.093,97.8939965 138.093,98.59 C138.093,98.7220007 138.09,98.8419995 138.084,98.95 C138.078,99.0580005 138.069,99.1779993 138.057,99.31 L131.775,99.364 Z M134.043,95.746 C133.394997,95.746 132.861002,95.9559979 132.441,96.376 C132.020998,96.7960021 131.799,97.3479966 131.775,98.032 L136.113,98.032 C136.089,97.3479966 135.906002,96.7960021 135.564,96.376 C135.221998,95.9559979 134.715003,95.746 134.043,95.746 Z M142.179,99.364 C142.263,100.192004 142.523998,100.794998 142.962,101.173 C143.400002,101.551002 144.002996,101.74 144.771,101.74 C145.263002,101.74 145.745998,101.662001 146.22,101.506 C146.694002,101.349999 147.104998,101.134001 147.453,100.858 L148.281,102.136 C147.740997,102.496002 147.153003,102.768999 146.517,102.955 C145.880997,103.141001 145.245003,103.234 144.609,103.234 C143.996997,103.234 143.418003,103.141001 142.872,102.955 C142.325997,102.768999 141.846002,102.490002 141.432,102.118 C141.017998,101.745998 140.688001,101.278003 140.442,100.714 C140.195999,100.149997 140.073,99.4840038 140.073,98.716 C140.073,98.0799968 140.183999,97.4920027 140.406,96.952 C140.628001,96.4119973 140.936998,95.947002 141.333,95.557 C141.729002,95.1669981 142.193997,94.8610011 142.728,94.639 C143.262003,94.4169989 143.834997,94.306 144.447,94.306 C145.035003,94.306 145.574998,94.3989991 146.067,94.585 C146.559002,94.7710009 146.984998,95.0439982 147.345,95.404 C147.705002,95.7640018 147.986999,96.2109973 148.191,96.745 C148.395001,97.2790027 148.497,97.8939965 148.497,98.59 C148.497,98.7220007 148.494,98.8419995 148.488,98.95 C148.482,99.0580005 148.473,99.1779993 148.461,99.31 L142.179,99.364 Z M144.447,95.746 C143.798997,95.746 143.265002,95.9559979 142.845,96.376 C142.424998,96.7960021 142.203,97.3479966 142.179,98.032 L146.517,98.032 C146.493,97.3479966 146.310002,96.7960021 145.968,96.376 C145.625998,95.9559979 145.119003,95.746 144.447,95.746 Z M153.033,89.824 L153.033,97.798 L156.579,94.468 L159.117,94.468 L154.977,98.518 L159.333,103 L156.741,103 L153.033,99.112 L153.033,103 L150.963,103 L150.963,89.824 L153.033,89.824 Z" id="Sleek"></path> </g> </svg> </div> </a> <nav class="header__links"> <div class="container header__links-wrapper"> <a class="header__link" href="/mcfed-weekly/" itemprop="url"> <span itemprop="name">Home</span> </a> <a class="header__link" href="/mcfed-weekly/about" itemprop="url"> <span itemprop="name">About</span> </a> </div> </nav> <div class="header__toggle"> <span></span> <span></span> <span></span> </div> </div> </div> </header> <div class="hero lazyload" data-bg="https://liuswin.github.io//mcfed-weekly/assets/img/posts/shane-rounce-205187.jpg"> <div class="hero__wrap"> <div class="hero__categories"> </div> <h1 class="hero__title">Github Actions</h1> <p class="hero__meta"> <span> <time>17 May 2020</time>&nbsp;&middot; </span> <span> 2 mins read </span> </p> </div> </div> <main class="site__content"> <div class="container"> <article class="post-content" itemprop="articleBody"> <div style="position: relative; height: 0; z-index: -1;"><img alt="github actions" src="https://github.githubassets.com/images/modules/actions/actions-hero.png" style="position: absolute; top: 0; right: 0;" /></div> <h2 id="github-actions">Github Actions</h2> <p>GitHub Actions可帮助您在存储代码的同一位置自动执行软件开发工作流程，并就请求请求和问题进行协作。您可以编写单个任务（称为操作），并将其组合以创建自定义工作流程。工作流是自定义的自动化流程，您可以在存储库中对其进行设置，以在GitHub上构建，测试，打包，发布或部署任何代码项目。 借助GitHub Actions，您可以直接在存储库中构建端到端的持续集成（CI）和持续部署（CD）功能。</p> <h2 id="核心概念"><a href="https://help.github.com/en/actions/getting-started-with-github-actions/core-concepts-for-github-actions">核心概念</a></h2> <p><strong>CI</strong><br /> 持续集成指的是，频繁地将代码集成到主干，集成到主干之前，必须通过自动化测试。 优点：1、快速发现错误。2、防止分支大幅偏离主干</p> <p><strong>CD</strong><br /> 持续部署是持续交付的下一步，指的是代码通过评审后，自动部署到生产环境</p> <p><strong>Workflow</strong><br /> 在 Github 上配置构建、测试、打包、发布或部署的自动化工作流程，工作流由一个或多个 Job 组成</p> <p><strong>Job</strong><br /> 由多个步骤组成的，工作流程中的一个作业步骤，可以定义工作流文件中作业的运行方式和依赖关系</p> <p><strong>Step</strong><br /> 步骤可以运行命令或 action 的单个任务</p> <p><strong>Action</strong><br /> 单独的任务，是工作流中最小的可移植构建快。</p> <p><strong>Event</strong><br /> 触发工作流程运行的特定事件</p> <p><strong>Runner</strong><br /> github 分配的用来执行 workflow 的构建服务器 (也可以自建 runner)</p> <h2 id="配置文件">配置文件</h2> <p>Github Actions 的 <strong><a href="https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions">Workflow file</a></strong>（配置文件）采用的是 YAML 类型的文件，文件存放在仓库根目录的 <code class="highlighter-rouge">.github/workflows</code> 目录中。仓库中存放至少一个作业。Github 发现仓库中存在配置文件就会在特定的事件触发后，自动执行配置的工作流程</p> <p>YAML 学习资源：</p> <p><a href="http://www.ruanyifeng.com/blog/2016/07/yaml.html">YAML 语言教程 - 阮一峰</a><br /> <a href="https://www.codeproject.com/Articles/1214409/Learn-YAML-in-five-minutes">Learn YAML in five minutes</a></p> <h3 id="配置字段">配置字段</h3> <ul> <li> <p>name<br /> <code class="highlighter-rouge">name</code> 字段是 workflow 的名称。如果省略该字段，Github默认使用workflow文件名称</p> </li> <li> <p>on<br /> required <code class="highlighter-rouge">on</code> 字段指定触发 workflow 的条件，通常是单个事件名称，或者事件数组，可以关联特定文件，标记或分支更改。</p> </li> </ul> <p>单个事件：</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Trigger on push</span>
<span class="na">on</span><span class="pi">:</span> <span class="s">push</span>
</code></pre></div></div> <p>事件列表：</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Trigger the workflow on push or pull request</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">,</span> <span class="nv">pull_request</span><span class="pi">]</span>
</code></pre></div></div> <p>多种类型示例：<a href="https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions#onevent_nametypes">活动、外部事件、定时运行等</a></p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">on</span><span class="pi">:</span>
  <span class="c1"># Trigger the workflow on push or pull request,</span>
  <span class="c1"># but only for the master branch</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">master</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">master</span>
  <span class="c1"># Also trigger on page_build, as well as release created events</span>
  <span class="na">page_build</span><span class="pi">:</span>
  <span class="na">release</span><span class="pi">:</span>
    <span class="na">types</span><span class="pi">:</span> <span class="c1"># This configuration does not affect the page_build event abve</span>
      <span class="pi">-</span> <span class="s">created</span>
</code></pre></div></div> <ul> <li>jobs<br /> workflow 文件由一个或多个 <code class="highlighter-rouge">job</code> 组成，每个作业必须包含一个ID，所有的 <code class="highlighter-rouge">job</code> 都是并行的，但往往都会有依赖关系。下面 <code class="highlighter-rouge">my_first_job</code> <code class="highlighter-rouge">my_second_job</code> 就是每个 Job 的 ID, 必须以字母或 <code class="highlighter-rouge">_</code> 开头，并且仅包含字母数字字符</li> </ul> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">jobs</span><span class="pi">:</span>
  <span class="na">my_first_job</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">My first job</span>
  <span class="na">my_second_job</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">My second job</span>
</code></pre></div></div> <ul> <li>jobs.<job_id>.name</job_id></li> <li>jobs.<jobid>.needs<br /> `needs` 指定 `job` 依赖关系</jobid></li> </ul> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 测试通过后，才能部署</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">test</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="s">test</span>
</code></pre></div></div> <ul> <li>jobs.<job_id>.runs-on<br /> 指定 `github actions` 的运行环境，github 默认会分配一个[服务器](https://help.github.com/en/actions/reference/virtual-environments-for-github-hosted-runners)给我们的构建工作流程使用</job_id></li> </ul> <table> <thead> <tr> <th style="text-align: left">Virtual environment</th> <th style="text-align: left">YAML workflow label</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Windows Server 2019</td> <td style="text-align: left">windows-latest or windows-2019</td> </tr> <tr> <td style="text-align: left">Ubuntu 18.04</td> <td style="text-align: left">ubuntu-latest or ubuntu-18.04</td> </tr> <tr> <td style="text-align: left">Ubuntu 16.04</td> <td style="text-align: left">ubuntu-16.04</td> </tr> <tr> <td style="text-align: left">macOS Catalina 10.15</td> <td style="text-align: left">macos-latest or macos-10.15</td> </tr> </tbody> </table> <ul> <li> <p>jobs.<job_id>.steps `job` 包含一系列称为 steps 的任务。step可以运行命令，安装依赖、编译代码等</job_id></p> </li> <li> <p>jobs.<job_id>.steps.name</job_id></p> </li> <li> <p>jobs.<job_id>.setps.run<br /> step 需要在 `shell` 执行的命令</job_id></p> </li> </ul> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">install dependencies</span>
  <span class="na">run</span><span class="pi">:</span> <span class="s">npm install</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">install and build</span>
  <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">npm install</span>
    <span class="s">npm run build</span>
</code></pre></div></div> <ul> <li>jobs.<job_id>.steps.uses<br /> 选择使用已有的 `action`，有利于代码复用。</job_id></li> </ul> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">GitHub Checkout</span>
  <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v1</span>
</code></pre></div></div> <h2 id="实战">实战</h2> <p>部署 create-react-app 生成的项目：<a href="https://github.com/liuswin/github-actions-demo">demo</a></p> </article> <div class="post-content controls__inner"> <div class="controls__item prev"> <span>Previous</span> <a href="/mcfed-weekly/2017/11/26/getting-started.html"> <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"> <path fill="fillColor" d="M5.647 1.718c.37-.434.323-1.09-.106-1.465A1.016 1.016 0 0 0 4.095.36L.25 4.875a1.05 1.05 0 0 0 .017 1.378l3.95 4.407c.38.424 1.03.456 1.448.07a1.05 1.05 0 0 0 .07-1.468l-3.34-3.725 3.253-3.819z"/> </svg> </span> Getting Started with Sleek </a> </div> <div class="controls__item next"> </div> </div> </div> <div class="comments"> <div class="container"> <div class="post-content"> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = 'https://liuswin.github.io//mcfed-weekly/2020/05/17/Github-Actions.html'; this.page.identifier = 'https://liuswin.github.io//mcfed-weekly/2020/05/17/Github-Actions.html'; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://janczizikow.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the comments.</noscript> </div> </div> </div> </main> <footer class="footer"> <div class="container"> <nav class="social"> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/jekyll"> <svg class="social__icon" viewBox="0 0 20 20" width="20px" height="20px"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg> </a> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://www.twitter.com/jekyllrb"> <svg class="social__icon" viewBox="0 0 20 20" width="20px" height="20px"><path d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg> </a> </nav> <span>&copy; 2020 MCFED. All rights reserved.</span> </div> </footer> <script async src="/mcfed-weekly/assets/js/bundle.js"></script> </body> </html>
